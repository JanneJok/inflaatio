// Process the Google Sheets data
const data = {
  "range": "Raakadata!A1:B350",
  "majorDimension": "ROWS",
  "values": [
    ["Kuukausi", "Inflaatio %"],
    ["1997-01", "0.9 %"],
    ["1997-02", "0.6 %"],
    ["1997-03", "0.7 %"],
    ["1997-04", "0.9 %"],
    ["1997-05", "0.9 %"],
    ["1997-06", "1.1 %"],
    ["1997-07", "1.1 %"],
    ["1997-08", "1.7 %"],
    ["1997-09", "1.6 %"],
    ["1997-10", "1.7 %"],
    ["1997-11", "1.8 %"],
    ["1997-12", "1.6 %"],
    ["1998-01", "1.8 %"],
    ["1998-02", "1.7 %"],
    ["1998-03", "1.6 %"],
    ["1998-04", "1.7 %"],
    ["1998-05", "1.6 %"],
    ["1998-06", "1.6 %"],
    ["1998-07", "1.1 %"],
    ["1998-08", "1.1 %"],
    ["1998-09", "1.4 %"],
    ["1998-10", "1.1 %"],
    ["1998-11", "0.9 %"],
    ["1998-12", "0.8 %"],
    ["1999-01", "0.5 %"],
    ["1999-02", "0.9 %"],
    ["1999-03", "0.9 %"],
    ["1999-04", "1.3 %"],
    ["1999-05", "1.4 %"],
    ["1999-06", "1.2 %"],
    ["1999-07", "1.4 %"],
    ["1999-08", "1.3 %"],
    ["1999-09", "1.4 %"],
    ["1999-10", "1.6 %"],
    ["1999-11", "1.9 %"],
    ["1999-12", "2.2 %"],
    ["2000-01", "2.3 %"],
    ["2000-02", "2.7 %"],
    ["2000-03", "3.2 %"],
    ["2000-04", "2.5 %"],
    ["2000-05", "2.7 %"],
    ["2000-06", "3.1 %"],
    ["2000-07", "2.9 %"],
    ["2000-08", "2.9 %"],
    ["2000-09", "3.4 %"],
    ["2000-10", "3.4 %"],
    ["2000-11", "3.3 %"],
    ["2000-12", "2.9 %"],
    ["2001-01", "2.9 %"],
    ["2001-02", "2.7 %"],
    ["2001-03", "2.5 %"],
    ["2001-04", "2.9 %"],
    ["2001-05", "3.3 %"],
    ["2001-06", "3 %"],
    ["2001-07", "2.6 %"],
    ["2001-08", "2.7 %"],
    ["2001-09", "2.6 %"],
    ["2001-10", "2.4 %"],
    ["2001-11", "2.2 %"],
    ["2001-12", "2.3 %"],
    ["2002-01", "2.9 %"],
    ["2002-02", "2.5 %"],
    ["2002-03", "2.6 %"],
    ["2002-04", "2.5 %"],
    ["2002-05", "1.8 %"],
    ["2002-06", "1.5 %"],
    ["2002-07", "2 %"],
    ["2002-08", "1.8 %"],
    ["2002-09", "1.3 %"],
    ["2002-10", "1.7 %"],
    ["2002-11", "1.7 %"],
    ["2002-12", "1.7 %"],
    ["2003-01", "1.4 %"],
    ["2003-02", "2.1 %"],
    ["2003-03", "1.8 %"],
    ["2003-04", "1.4 %"],
    ["2003-05", "1.1 %"],
    ["2003-06", "1.1 %"],
    ["2003-07", "1 %"],
    ["2003-08", "1.2 %"],
    ["2003-09", "1.3 %"],
    ["2003-10", "0.9 %"],
    ["2003-11", "1.1 %"],
    ["2003-12", "1.2 %"],
    ["2004-01", "0.7 %"],
    ["2004-02", "0.4 %"],
    ["2004-03", "-0.4 %"],
    ["2004-04", "-0.4 %"],
    ["2004-05", "-0.1 %"],
    ["2004-06", "-0.1 %"],
    ["2004-07", "0.2 %"],
    ["2004-08", "0.2 %"],
    ["2004-09", "0.2 %"],
    ["2004-10", "0.6 %"],
    ["2004-11", "0.2 %"],
    ["2004-12", "0.1 %"],
    ["2005-01", "-0.1 %"],
    ["2005-02", "0 %"],
    ["2005-03", "0.9 %"],
    ["2005-04", "1.2 %"],
    ["2005-05", "0.7 %"],
    ["2005-06", "1 %"],
    ["2005-07", "0.9 %"],
    ["2005-08", "1 %"],
    ["2005-09", "1.2 %"],
    ["2005-10", "0.8 %"],
    ["2005-11", "0.9 %"],
    ["2005-12", "1 %"],
    ["2006-01", "1.2 %"],
    ["2006-02", "1.3 %"],
    ["2006-03", "1.2 %"],
    ["2006-04", "1.5 %"],
    ["2006-05", "1.7 %"],
    ["2006-06", "1.5 %"],
    ["2006-07", "1.3 %"],
    ["2006-08", "1.3 %"],
    ["2006-09", "0.8 %"],
    ["2006-10", "1 %"],
    ["2006-11", "1.3 %"],
    ["2006-12", "1.2 %"],
    ["2007-01", "1.3 %"],
    ["2007-02", "1.2 %"],
    ["2007-03", "1.6 %"],
    ["2007-04", "1.5 %"],
    ["2007-05", "1.3 %"],
    ["2007-06", "1.4 %"],
    ["2007-07", "1.6 %"],
    ["2007-08", "1.3 %"],
    ["2007-09", "1.7 %"],
    ["2007-10", "1.8 %"],
    ["2007-11", "2.2 %"],
    ["2007-12", "1.9 %"],
    ["2008-01", "3.4 %"],
    ["2008-02", "3.3 %"],
    ["2008-03", "3.6 %"],
    ["2008-04", "3.3 %"],
    ["2008-05", "4.1 %"],
    ["2008-06", "4.3 %"],
    ["2008-07", "4.3 %"],
    ["2008-08", "4.6 %"],
    ["2008-09", "4.7 %"],
    ["2008-10", "4.4 %"],
    ["2008-11", "3.5 %"],
    ["2008-12", "3.4 %"],
    ["2009-01", "2.5 %"],
    ["2009-02", "2.7 %"],
    ["2009-03", "2 %"],
    ["2009-04", "2.1 %"],
    ["2009-05", "1.5 %"],
    ["2009-06", "1.6 %"],
    ["2009-07", "1.2 %"],
    ["2009-08", "1.3 %"],
    ["2009-09", "1.1 %"],
    ["2009-10", "0.6 %"],
    ["2009-11", "1.3 %"],
    ["2009-12", "1.8 %"],
    ["2010-01", "1.6 %"],
    ["2010-02", "1.3 %"],
    ["2010-03", "1.5 %"],
    ["2010-04", "1.6 %"],
    ["2010-05", "1.4 %"],
    ["2010-06", "1.3 %"],
    ["2010-07", "1.3 %"],
    ["2010-08", "1.3 %"],
    ["2010-09", "1.4 %"],
    ["2010-10", "2.4 %"],
    ["2010-11", "2.4 %"],
    ["2010-12", "2.8 %"],
    ["2011-01", "3.1 %"],
    ["2011-02", "3.5 %"],
    ["2011-03", "3.5 %"],
    ["2011-04", "3.4 %"],
    ["2011-05", "3.4 %"],
    ["2011-06", "3.4 %"],
    ["2011-07", "3.7 %"],
    ["2011-08", "3.5 %"],
    ["2011-09", "3.5 %"],
    ["2011-10", "3.2 %"],
    ["2011-11", "3.2 %"],
    ["2011-12", "2.6 %"],
    ["2012-01", "3 %"],
    ["2012-02", "3 %"],
    ["2012-03", "2.9 %"],
    ["2012-04", "3 %"],
    ["2012-05", "3.1 %"],
    ["2012-06", "2.9 %"],
    ["2012-07", "3.1 %"],
    ["2012-08", "3.3 %"],
    ["2012-09", "3.4 %"],
    ["2012-10", "3.5 %"],
    ["2012-11", "3.2 %"],
    ["2012-12", "3.4 %"],
    ["2013-01", "2.6 %"],
    ["2013-02", "2.4 %"],
    ["2013-03", "2.5 %"],
    ["2013-04", "2.4 %"],
    ["2013-05", "2.5 %"],
    ["2013-06", "2.3 %"],
    ["2013-07", "2.5 %"],
    ["2013-08", "2.1 %"],
    ["2013-09", "1.8 %"],
    ["2013-10", "1.7 %"],
    ["2013-11", "1.8 %"],
    ["2013-12", "1.9 %"],
    ["2014-01", "1.9 %"],
    ["2014-02", "1.6 %"],
    ["2014-03", "1.3 %"],
    ["2014-04", "1.3 %"],
    ["2014-05", "1 %"],
    ["2014-06", "1.1 %"],
    ["2014-07", "1 %"],
    ["2014-08", "1.2 %"],
    ["2014-09", "1.5 %"],
    ["2014-10", "1.2 %"],
    ["2014-11", "1.1 %"],
    ["2014-12", "0.6 %"],
    ["2015-01", "-0.1 %"],
    ["2015-02", "-0.1 %"],
    ["2015-03", "0 %"],
    ["2015-04", "-0.1 %"],
    ["2015-05", "0.1 %"],
    ["2015-06", "0.1 %"],
    ["2015-07", "-0.1 %"],
    ["2015-08", "-0.2 %"],
    ["2015-09", "-0.7 %"],
    ["2015-10", "-0.3 %"],
    ["2015-11", "-0.2 %"],
    ["2015-12", "-0.2 %"],
    ["2016-01", "0 %"],
    ["2016-02", "-0.1 %"],
    ["2016-03", "0 %"],
    ["2016-04", "0.3 %"],
    ["2016-05", "0.3 %"],
    ["2016-06", "0.3 %"],
    ["2016-07", "0.5 %"],
    ["2016-08", "0.5 %"],
    ["2016-09", "0.5 %"],
    ["2016-10", "0.6 %"],
    ["2016-11", "0.6 %"],
    ["2016-12", "1.1 %"],
    ["2017-01", "0.9 %"],
    ["2017-02", "1.4 %"],
    ["2017-03", "0.9 %"],
    ["2017-04", "1 %"],
    ["2017-05", "0.9 %"],
    ["2017-06", "0.9 %"],
    ["2017-07", "0.6 %"],
    ["2017-08", "0.8 %"],
    ["2017-09", "0.8 %"],
    ["2017-10", "0.5 %"],
    ["2017-11", "0.9 %"],
    ["2017-12", "0.5 %"],
    ["2018-01", "0.8 %"],
    ["2018-02", "0.6 %"],
    ["2018-03", "0.9 %"],
    ["2018-04", "0.8 %"],
    ["2018-05", "1 %"],
    ["2018-06", "1.2 %"],
    ["2018-07", "1.4 %"],
    ["2018-08", "1.4 %"],
    ["2018-09", "1.4 %"],
    ["2018-10", "1.7 %"],
    ["2018-11", "1.4 %"],
    ["2018-12", "1.3 %"],
    ["2019-01", "1.2 %"],
    ["2019-02", "1.3 %"],
    ["2019-03", "1.1 %"],
    ["2019-04", "1.5 %"],
    ["2019-05", "1.3 %"],
    ["2019-06", "1.1 %"],
    ["2019-07", "1 %"],
    ["2019-08", "1.2 %"],
    ["2019-09", "1 %"],
    ["2019-10", "0.9 %"],
    ["2019-11", "0.8 %"],
    ["2019-12", "1.1 %"],
    ["2020-01", "1.2 %"],
    ["2020-02", "1.1 %"],
    ["2020-03", "0.9 %"],
    ["2020-04", "-0.3 %"],
    ["2020-05", "-0.1 %"],
    ["2020-06", "0.1 %"],
    ["2020-07", "0.7 %"],
    ["2020-08", "0.3 %"],
    ["2020-09", "0.3 %"],
    ["2020-10", "0.2 %"],
    ["2020-11", "0.2 %"],
    ["2020-12", "0.2 %"],
    ["2021-01", "1 %"],
    ["2021-02", "0.9 %"],
    ["2021-03", "1.4 %"],
    ["2021-04", "2.2 %"],
    ["2021-05", "2.3 %"],
    ["2021-06", "1.9 %"],
    ["2021-07", "1.8 %"],
    ["2021-08", "1.8 %"],
    ["2021-09", "2.1 %"],
    ["2021-10", "2.8 %"],
    ["2021-11", "3.5 %"],
    ["2021-12", "3.2 %"],
    ["2022-01", "4.1 %"],
    ["2022-02", "4.4 %"],
    ["2022-03", "5.8 %"],
    ["2022-04", "5.8 %"],
    ["2022-05", "7.1 %"],
    ["2022-06", "8.1 %"],
    ["2022-07", "8 %"],
    ["2022-08", "7.9 %"],
    ["2022-09", "8.4 %"],
    ["2022-10", "8.4 %"],
    ["2022-11", "9.1 %"],
    ["2022-12", "8.8 %"],
    ["2023-01", "7.9 %"],
    ["2023-02", "8 %"],
    ["2023-03", "6.7 %"],
    ["2023-04", "6.3 %"],
    ["2023-05", "5 %"],
    ["2023-06", "4.1 %"],
    ["2023-07", "4.2 %"],
    ["2023-08", "3.1 %"],
    ["2023-09", "3 %"],
    ["2023-10", "2.4 %"],
    ["2023-11", "0.7 %"],
    ["2023-12", "1.3 %"],
    ["2024-01", "1.1 %"],
    ["2024-02", "1.1 %"],
    ["2024-03", "0.6 %"],
    ["2024-04", "0.6 %"],
    ["2024-05", "0.4 %"],
    ["2024-06", "0.5 %"],
    ["2024-07", "0.5 %"],
    ["2024-08", "1.1 %"],
    ["2024-09", "1 %"],
    ["2024-10", "1.5 %"],
    ["2024-11", "1.7 %"],
    ["2024-12", "1.6 %"],
    ["2025-01", "1.7 %"],
    ["2025-02", "1.5 %"],
    ["2025-03", "1.8 %"],
    ["2025-04", "1.9 %"],
    ["2025-05", "2 %"],
    ["2025-06", "1.9 %"],
    ["2025-07", "1.9 %"],
    ["2025-08", "2.2 %"],
    ["2025-09", "2.3 %"]
  ]
};

// Dictionary to store yearly data
const yearlyData = {};

// Process each row (skip header at index 0)
for (let i = 1; i < data.values.length; i++) {
  const row = data.values[i];
  if (row.length >= 2) {
    const dateStr = row[0]; // Format: "YYYY-MM"
    const inflationStr = row[1]; // Format: "X.X %" or "X %"

    // Extract year
    const year = parseInt(dateStr.split('-')[0]);

    // Parse inflation percentage
    // Remove "%" and spaces, replace comma with dot
    const inflationValue = inflationStr.replace('%', '').replace(',', '.').trim();
    const inflationFloat = parseFloat(inflationValue);

    // Add to yearly data
    if (!yearlyData[year]) {
      yearlyData[year] = [];
    }
    yearlyData[year].push(inflationFloat);
  }
}

// Calculate and print yearly averages for 2000-2025
console.log("GOOGLE SHEETS DATA (vuosikeskiarvot):");
console.log("Year | Average | Months of data");

for (let year = 2000; year <= 2025; year++) {
  if (yearlyData[year]) {
    const values = yearlyData[year];
    const sum = values.reduce((a, b) => a + b, 0);
    const average = sum / values.length;
    const monthsCount = values.length;
    console.log(`${year} | ${average.toFixed(1)}%   | ${monthsCount}`);
  } else {
    console.log(`${year} | N/A    | 0`);
  }
}
